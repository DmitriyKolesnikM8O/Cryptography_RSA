<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:CryptoApp.ViewModels"
        x:Class="CryptoApp.Views.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Icon="/Assets/avalonia-logo.ico"
        Title="Криптографический инструментарий RSA"
        Width="850" Height="600">

    <TabControl>
        <!-- ВКЛАДКА №1: RSA ШИФРОВАНИЕ (УЖЕ РАБОТАЕТ) -->
        <TabItem Header="RSA Шифрование">
            <DockPanel>
                <Border DockPanel.Dock="Bottom" BorderThickness="0,1,0,0" BorderBrush="LightGray" Padding="5" Margin="0,10,0,0">
                    <StackPanel Orientation="Horizontal" Spacing="10">
                        <ProgressBar IsIndeterminate="True" IsVisible="{Binding IsBusy}" Width="100" VerticalAlignment="Center"/>
                        <TextBlock Text="{Binding StatusMessage}" Foreground="Gray" VerticalAlignment="Center"/>
                    </StackPanel>
                </Border>
                <Grid ColumnDefinitions="*,*" Margin="10">
                    <StackPanel Grid.Column="0" Spacing="10" Margin="0,0,10,0">
                        <TextBlock Text="1. Генерация ключей" FontWeight="Bold"/>
                        <TextBlock Text="Битность (для p и q):"/>
                        <ComboBox ItemsSource="{Binding AvailableBitLengths}" SelectedItem="{Binding SelectedBitLength}" IsEnabled="{Binding !IsBusy}"/>
                        <TextBlock Text="Тест простоты:"/>
                        <ComboBox ItemsSource="{Binding TestTypes}" SelectedItem="{Binding SelectedTestType}" IsEnabled="{Binding !IsBusy}"/>
                        <Button Content="Сгенерировать ключи" Command="{Binding GenerateKeysCommand}" HorizontalAlignment="Stretch"/>
                        <TextBlock Text="2. Шифрование" FontWeight="Bold" Margin="0,15,0,0"/>
                        <TextBlock Text="Сообщение (число):"/>
                        <TextBox Text="{Binding MessageToEncrypt}" IsEnabled="{Binding !IsBusy}"/>
                        <Button Content="Зашифровать" Command="{Binding EncryptCommand}" HorizontalAlignment="Stretch"/>
                    </StackPanel>
                    <StackPanel Grid.Column="1" Spacing="10" Margin="10,0,0,0">
                        <TextBlock Text="Сгенерированные ключи" FontWeight="Bold"/>
                        <TextBlock Text="Открытый ключ (E):"/>
                        <TextBox Text="{Binding PublicKeyE}" IsReadOnly="True"/>
                        <TextBlock Text="Открытый/Закрытый модуль (N):"/>
                        <TextBox Text="{Binding PublicKeyN}" IsReadOnly="True" TextWrapping="Wrap" MaxHeight="80"/>
                        <TextBlock Text="Закрытый ключ (D):"/>
                        <TextBox Text="{Binding PrivateKeyD}" IsReadOnly="True" TextWrapping="Wrap" MaxHeight="80"/>
                        <TextBlock Text="3. Результаты" FontWeight="Bold" Margin="0,15,0,0"/>
                        <TextBlock Text="Зашифрованное сообщение (C):"/>
                        <TextBox Text="{Binding EncryptedMessage}" IsReadOnly="True" TextWrapping="Wrap" MaxHeight="80"/>
                        <Button Content="Расшифровать" Command="{Binding DecryptCommand}" HorizontalAlignment="Left" Margin="0,5,0,0"/>
                        <TextBlock Text="Расшифрованное сообщение:" Margin="0,5,0,0"/>
                        <TextBox Text="{Binding DecryptedMessage}" IsReadOnly="True"/>
                    </StackPanel>
                </Grid>
            </DockPanel>
        </TabItem>

        <!-- ВКЛАДКА №2: ТЕСТЕР ПРОСТОТЫ (ИСПРАВЛЕННАЯ) -->
        <TabItem Header="Тестер простоты">
            <StackPanel Spacing="10" Margin="20">
                <TextBlock Text="Введите число для проверки на простоту:" FontSize="16"/>
                <TextBox Text="{Binding NumberToTest}" Watermark="Введите большое целое число" IsEnabled="{Binding !IsBusy}"/>
                <TextBlock Text="Выберите метод тестирования:" FontSize="16" Margin="0,10,0,0"/>
                <ComboBox ItemsSource="{Binding TestTypes}" SelectedItem="{Binding SelectedTestTypeForCheck}" IsEnabled="{Binding !IsBusy}"/>
                <Button Content="Проверить" Command="{Binding CheckPrimalityCommand}" HorizontalAlignment="Stretch" Margin="0,10,0,0"/>
                <Border BorderBrush="Gray" BorderThickness="1" Padding="15" Margin="0,20,0,0">
                    <StackPanel>
                        <TextBlock Text="Результат:" FontSize="16" FontWeight="Bold"/>
                        <TextBlock Text="{Binding PrimalityTestResult}" FontSize="14" TextWrapping="Wrap" Margin="0,5,0,0" Foreground="{Binding IsResultPrime, Converter={StaticResource BoolToColorConverter}}"/>
                    </StackPanel>
                </Border>
            </StackPanel>
        </TabItem>

        <!-- ВКЛАДКА №3: АТАКА ВИНЕРА (ЗАГЛУШКА) -->
        <TabItem Header="Атака Винера">
            <TextBlock Text="Здесь будет интерфейс для демонстрации атаки Винера." HorizontalAlignment="Center" VerticalAlignment="Center"/>
        </TabItem>

    </TabControl>
</Window>